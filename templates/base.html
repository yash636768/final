<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DermAI ‚Äî Professional Skin Disease Detection</title>
  <link href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
  /* Professional Medical UI - White & Blue Theme */
  * {
    box-sizing: border-box;
  }
  
  body {
    background: linear-gradient(135deg, #f5f7fa 0%, #e8f0f5 100%);
    color: #2c3e50;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    min-height: 100vh;
    padding-bottom: 120px;
    line-height: 1.6;
  }

  /* Navigation */
  .medical-nav {
    background: #ffffff;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
    border-bottom: 3px solid #2563eb;
    padding: 12px 0;
  }

  .logo-icon {
    height: 42px;
    filter: drop-shadow(0 2px 4px rgba(37, 99, 235, 0.2));
  }

  .navbar-brand {
    color: #1e40af !important;
    font-weight: 700;
    font-size: 22px;
    letter-spacing: -0.5px;
  }

  .nav-link {
    color: #475569 !important;
    font-weight: 500;
    margin: 0 8px;
    transition: color 0.3s ease;
  }

  .nav-link:hover {
    color: #2563eb !important;
  }

  /* Hero Section */
  .hero-section {
    padding: 60px 0 40px;
    text-align: center;
    background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
    color: #ffffff;
    margin-bottom: 40px;
    box-shadow: 0 4px 20px rgba(37, 99, 235, 0.15);
  }

  .hero-title {
    font-size: 42px;
    font-weight: 700;
    margin-bottom: 16px;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  }

  .hero-subtitle {
    font-size: 18px;
    opacity: 0.95;
    font-weight: 400;
  }

  /* Cards */
  .upload-card, .result-card {
    background: #ffffff;
    padding: 32px;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    border: 1px solid #e2e8f0;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .upload-card:hover, .result-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
  }

  .upload-card h4, .result-card h5 {
    color: #1e40af;
    font-weight: 600;
    margin-bottom: 20px;
  }

  /* Preview Image */
  .preview-img {
    width: 100%;
    border-radius: 12px;
    display: block;
    margin: 16px 0;
    border: 2px solid #e2e8f0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  }

  .hide {
    display: none;
  }

  /* Buttons */
  .btn-astro {
    background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
    border: none;
    border-radius: 10px;
    color: #ffffff;
    font-weight: 600;
    padding: 12px 24px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
  }

  .btn-astro:hover {
    background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
    color: #ffffff;
  }

  .btn-astro:active {
    transform: translateY(0);
  }

  /* Badges */
  .cosmic-badge {
    background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
    color: #ffffff;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 14px;
  }

  /* File Input */
  .custom-file-label {
    background: #f8fafc;
    border: 2px dashed #cbd5e1;
    color: #475569;
    padding: 12px;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .custom-file-label:hover {
    background: #f1f5f9;
    border-color: #2563eb;
  }

  .custom-file-input:focus ~ .custom-file-label {
    border-color: #2563eb;
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
  }

  .custom-file-input ~ .custom-file-label::after {
    content: "Browse";
    background: #2563eb;
    color: #ffffff;
    border-radius: 6px;
    padding: 6px 16px;
    font-weight: 600;
  }

  /* List Items */
  .list-group-item {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    color: #334155;
    padding: 16px;
    margin-bottom: 8px;
    border-radius: 10px;
    transition: all 0.3s ease;
  }

  .list-group-item:hover {
    background: #f1f5f9;
    border-color: #2563eb;
    transform: translateX(4px);
  }

  /* Tables */
  .table {
    background: #ffffff;
  }

  .table thead th {
    background: #f8fafc;
    color: #1e40af;
    font-weight: 600;
    border-bottom: 2px solid #2563eb;
    padding: 14px;
  }

  .table tbody td {
    padding: 12px 14px;
    color: #475569;
    border-bottom: 1px solid #e2e8f0;
  }

  .table tbody tr:hover {
    background: #f8fafc;
  }

  /* Confidence Bars */
  .confidence-bars {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .confidence-item {
    padding: 16px;
    background: #f8fafc;
    border-radius: 12px;
    border: 1px solid #e2e8f0;
    transition: all 0.3s ease;
  }

  .confidence-item:hover {
    background: #f1f5f9;
    border-color: #2563eb;
    transform: translateX(4px);
  }

  .confidence-label {
    color: #1e40af;
    font-size: 16px;
    margin-bottom: 12px;
    font-weight: 600;
  }

  .confidence-bar {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 4px;
  }

  .confidence-block,
  .confidence-block-empty {
    font-size: 20px;
    line-height: 1;
    display: inline-block;
  }

  .confidence-label-text {
    margin-left: 12px;
    color: #475569;
    font-size: 14px;
    font-weight: 500;
  }

  /* Disease Information Section */
  .disease-info-card {
    background: #ffffff;
    padding: 32px;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    border-left: 5px solid #2563eb;
    margin-top: 24px;
  }

  .disease-info-card h4 {
    color: #1e40af;
    text-align: center;
    font-weight: 700;
    margin-bottom: 28px;
    font-size: 26px;
  }

  .disease-info-card h5 {
    color: #2563eb;
    margin-bottom: 14px;
    font-size: 20px;
    font-weight: 600;
    margin-top: 24px;
  }

  .disease-info-card p {
    color: #475569;
    line-height: 1.8;
    font-size: 15px;
  }

  .disease-info-card ul {
    color: #475569;
    line-height: 2;
    padding-left: 24px;
    font-size: 15px;
  }

  .disease-info-card li {
    margin-bottom: 10px;
  }

  .warning-box {
    background: #fef3c7;
    border-left: 4px solid #f59e0b;
    padding: 16px;
    border-radius: 8px;
    margin-top: 24px;
  }

  .warning-box p {
    color: #92400e;
    margin: 0;
    font-size: 14px;
    font-weight: 600;
  }

  /* Questionnaire */
  .questionnaire-card {
    background: #ffffff;
    padding: 32px;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    border: 1px solid #e2e8f0;
    margin-top: 24px;
  }

  .question-group {
    background: #f8fafc;
    padding: 20px;
    border-radius: 12px;
    border-left: 4px solid #2563eb;
    margin-bottom: 20px;
    transition: all 0.3s ease;
  }

  .question-group:hover {
    background: #f1f5f9;
    border-left-color: #1e40af;
  }

  .question-group label {
    color: #1e40af;
    font-weight: 600;
    font-size: 16px;
    margin-bottom: 14px;
    display: block;
  }

  .form-check-label {
    color: #475569;
    cursor: pointer;
    font-weight: 400;
  }

  .form-check-input:checked {
    background-color: #2563eb;
    border-color: #2563eb;
  }

  .form-check-input:focus {
    border-color: #2563eb;
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
  }

  #questionnaire-results {
    background: #f0f9ff;
    border: 2px solid #2563eb;
    border-radius: 12px;
    padding: 24px;
    margin-top: 24px;
  }

  #questionnaire-results h5 {
    color: #1e40af;
    margin-bottom: 16px;
    font-weight: 600;
  }

  #results-content {
    color: #475569;
    line-height: 1.8;
  }

  /* About Section */
  .about-section {
    padding: 60px 0;
    background: #ffffff;
    margin-top: 60px;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }

  .about-section h2 {
    color: #1e40af;
    font-weight: 700;
    margin-bottom: 20px;
  }

  .about-text {
    color: #475569;
    font-size: 16px;
    max-width: 800px;
    margin: 0 auto;
  }

  /* Footer */
  .footer-section {
    text-align: center;
    padding: 32px;
    margin-top: 60px;
    background: #ffffff;
    color: #64748b;
    border-top: 3px solid #e2e8f0;
    border-radius: 16px 16px 0 0;
  }

  /* Chatbot */
  #chatbot-icon-fixed {
    position: fixed;
    right: 30px;
    bottom: 30px;
    width: 64px;
    height: 64px;
    background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
    color: #ffffff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 99999;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(37, 99, 235, 0.4);
    font-size: 24px;
    transition: all 0.3s ease;
  }

  #chatbot-icon-fixed:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 30px rgba(37, 99, 235, 0.5);
  }

  #chatbot-box-fixed {
    position: fixed;
    right: 30px;
    bottom: 110px;
    width: 360px;
    height: 500px;
    background: #ffffff;
    border-radius: 16px;
    border: 2px solid #e2e8f0;
    display: flex;
    flex-direction: column;
    z-index: 100000;
    color: #2c3e50;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
  }

  .chatbot-hidden {
    display: none !important;
  }

  .chatbot-header-fixed {
    background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
    color: #ffffff;
    padding: 16px;
    border-radius: 14px 14px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 600;
  }

  #chatbot-minimize-btn {
    cursor: pointer;
    font-size: 24px;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background 0.3s ease;
  }

  #chatbot-minimize-btn:hover {
    background: rgba(255, 255, 255, 0.2);
  }

  .chatbot-body-fixed {
    flex: 1;
    padding: 16px;
    overflow-y: auto;
    background: #f8fafc;
  }

  .chat-msg {
    max-width: 80%;
    padding: 12px 16px;
    border-radius: 12px;
    margin-bottom: 12px;
    line-height: 1.5;
    font-size: 14px;
  }

  .user-msg {
    background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
    color: #ffffff;
    margin-left: auto;
    border-bottom-right-radius: 4px;
  }

  .bot-msg {
    background: #ffffff;
    color: #475569;
    border: 1px solid #e2e8f0;
    border-bottom-left-radius: 4px;
  }

  .chatbot-input-area-fixed {
    display: flex;
    padding: 16px;
    border-top: 2px solid #e2e8f0;
    background: #ffffff;
    border-radius: 0 0 14px 14px;
  }

  #chatbot-input {
    flex: 1;
    border: 2px solid #e2e8f0;
    background: #f8fafc;
    color: #2c3e50;
    padding: 10px 14px;
    border-radius: 10px;
    font-size: 14px;
  }

  #chatbot-input:focus {
    outline: none;
    border-color: #2563eb;
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
  }

  #chatbot-send {
    margin-left: 10px;
    background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
    border: none;
    color: #ffffff;
    padding: 10px 20px;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  #chatbot-send:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
  }

  /* Result Text */
  .result-text {
    color: #1e40af;
    font-weight: 600;
    font-size: 20px;
    margin-top: 20px;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .hero-title {
      font-size: 28px;
    }

    .hero-subtitle {
      font-size: 16px;
    }

    #chatbot-box-fixed {
      width: calc(100% - 40px);
      right: 20px;
      left: 20px;
    }
  }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg medical-nav">
    <div class="container">
      <div class="d-flex align-items-center">
        <img src="https://cdn-icons-png.flaticon.com/512/3212/3212608.png" class="logo-icon" alt="logo" />
        <a class="navbar-brand ml-2" href="#">DermAI</a>
      </div>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navMenu">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navMenu">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="#about-us">About</a></li>
          <li class="nav-item"><a class="nav-link" href="/find-dermatologist">Find Dermatologist</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <section class="hero-section">
    <div class="container">
      <h1 class="hero-title animate__animated animate__fadeInDown">AI-Powered Skin Disease Detection</h1>
      <p class="hero-subtitle animate__animated animate__fadeInUp">Professional ‚Ä¢ Accurate ‚Ä¢ Trusted by Healthcare Providers</p>
    </div>
  </section>

  <div class="container main-section animate__animated animate__zoomIn">
    <div class="row justify-content-center">
      <div class="col-md-5">
        <div class="upload-card">
          <h4 class="text-center mb-3">üì§ Upload Skin Image</h4>

          <div class="text-center mb-3">
            <img id="previewImg" class="preview-img hide" alt="preview" />
          </div>

          <form action="/predict" method="post" id="upload-file" enctype="multipart/form-data">
            <div class="custom-file mb-3">
              <input type="file" class="custom-file-input" id="imageUpload" name="image" accept="image/*" required>
              <label class="custom-file-label" for="imageUpload">Choose skin image...</label>
            </div>

            <button type="submit" class="btn btn-astro btn-block mt-3">üîç Analyze Image</button>
          </form>

          <div id="loader" class="loader hide"></div>

          <h3 class="result-text text-center mt-4" id="result">{{ prediction_text|default('') }}</h3>
        </div>
      </div>

      <div class="col-md-6">
        <div class="result-card mt-3">
          <h5 class="mb-3">üìä Top Predictions</h5>
          <ul class="list-group cosmic-list">
            {% if top3 %}
            {% for label, prob, idx in top3 %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <span><strong>{{ loop.index }}.</strong> {{ label }}</span>
              <span class="badge cosmic-badge">{{ '%.1f'|format(prob * 100) }}%</span>
            </li>
            {% endfor %}
            {% else %}
            <li class="list-group-item d-flex justify-content-between align-items-center">No predictions yet <span class="badge cosmic-badge">‚Äî</span></li>
            {% endif %}
          </ul>
        </div>

        {% if all_probs %}
        <div class="result-card mt-3">
          <h5 class="mb-3">üìà Confidence per Class</h5>
          <div class="confidence-bars">
            {% for label, prob in all_probs %}
            {% set percentage = (prob * 100) %}
            {% set filled_blocks_raw = (percentage / 10) %}
            {% set filled_blocks = (filled_blocks_raw | int) %}
            {% if filled_blocks == 0 and percentage > 0 %}{% set filled_blocks = 1 %}{% endif %}
            {% if filled_blocks > 10 %}{% set filled_blocks = 10 %}{% endif %}
            {% if filled_blocks < 0 %}{% set filled_blocks = 0 %}{% endif %}
            {% set empty_blocks = 10 - filled_blocks %}
            
            {% if percentage >= 85 %}
              {% set emoji = "‚≠ê" %}
              {% set label_text = "Very High" %}
              {% set block_char = "üü¶" %}
            {% elif percentage >= 60 %}
              {% set emoji = "üîµ" %}
              {% set label_text = "High" %}
              {% set block_char = "üü¶" %}
            {% elif percentage >= 40 %}
              {% set emoji = "üü°" %}
              {% set label_text = "Moderate" %}
              {% set block_char = "üüß" %}
            {% elif percentage >= 20 %}
              {% set emoji = "üü†" %}
              {% set label_text = "Low" %}
              {% set block_char = "üüß" %}
            {% else %}
              {% set emoji = "üî¥" %}
              {% set label_text = "Very Low" %}
              {% set block_char = "üü•" %}
            {% endif %}
            
            <div class="confidence-item">
              <div class="confidence-label">
                <strong>{{ label }}</strong>
              </div>
              <div class="confidence-bar">
                {% for i in range(filled_blocks) %}
                <span class="confidence-block">{{ block_char }}</span>
                {% endfor %}
                {% for i in range(empty_blocks) %}
                <span class="confidence-block-empty">‚¨ú</span>
                {% endfor %}
                <span class="confidence-label-text">({{ emoji }} {{ label_text }} Confidence)</span>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
        {% endif %}

      </div>
    </div>

    <!-- Expanded Disease Information -->
    {% if disease_info %}
    <div class="disease-info-card">
      <h4>üìã Comprehensive Disease Information</h4>
      
      <!-- Description -->
      <div class="mb-4">
        <h5>üìñ Description</h5>
        <p>{{ disease_info.description }}</p>
      </div>

      <!-- Prevention -->
      <div class="mb-4">
        <h5>üõ°Ô∏è Prevention</h5>
        <ul>
          {% for item in disease_info.prevention %}
          <li>{{ item }}</li>
          {% endfor %}
        </ul>
      </div>

      <!-- Medical Treatments -->
      <div class="mb-4">
        <h5>üíä Medical Treatments & Cures</h5>
        <ul>
          {% for item in disease_info.cures %}
          <li>{{ item }}</li>
          {% endfor %}
        </ul>
      </div>

      <!-- Home Remedies -->
      <div class="mb-3">
        <h5>üåø Home Remedies & Natural Solutions</h5>
        <ul>
          {% for item in disease_info.remedies %}
          <li>{{ item }}</li>
          {% endfor %}
        </ul>
      </div>

      <!-- Important Note -->
      <div class="warning-box">
        <p>
          ‚ö†Ô∏è <strong>Important:</strong> This information is for educational purposes only. Always consult with a qualified healthcare professional for proper diagnosis and treatment.
        </p>
      </div>
    </div>
    {% endif %}

    <!-- Symptom Assessment Questionnaire -->
    {% if disease_info %}
    <div class="questionnaire-card">
      <h4 class="mb-3" style="color: #1e40af; text-align: center; font-weight: 700; font-size: 24px;">üîç Symptom Assessment Questionnaire</h4>
      <p style="color: #64748b; text-align: center; margin-bottom: 25px; font-size: 15px; font-style: italic;">Help us understand your symptoms better by answering these dermatologist-recommended questions</p>
      
      <form id="symptom-questionnaire">
        <!-- Question 1: Itching -->
        <div class="question-group">
          <label>
            <span style="margin-right: 8px;">1Ô∏è‚É£</span> Do you experience itching in the affected area?
          </label>
          <div style="margin-left: 30px;">
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="itching" id="itching-yes" value="yes">
              <label class="form-check-label" for="itching-yes">Yes</label>
            </div>
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="itching" id="itching-no" value="no">
              <label class="form-check-label" for="itching-no">No</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="itching" id="itching-sometimes" value="sometimes">
              <label class="form-check-label" for="itching-sometimes">Sometimes</label>
            </div>
          </div>
        </div>

        <!-- Question 2: Redness -->
        <div class="question-group">
          <label>
            <span style="margin-right: 8px;">2Ô∏è‚É£</span> Do you notice redness or inflammation in the affected area?
          </label>
          <div style="margin-left: 30px;">
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="redness" id="redness-yes" value="yes">
              <label class="form-check-label" for="redness-yes">Yes</label>
            </div>
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="redness" id="redness-no" value="no">
              <label class="form-check-label" for="redness-no">No</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="redness" id="redness-mild" value="mild">
              <label class="form-check-label" for="redness-mild">Mild</label>
            </div>
          </div>
        </div>

        <!-- Question 3: Swelling -->
        <div class="question-group">
          <label>
            <span style="margin-right: 8px;">3Ô∏è‚É£</span> Is there any swelling or raised areas on the skin?
          </label>
          <div style="margin-left: 30px;">
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="swelling" id="swelling-yes" value="yes">
              <label class="form-check-label" for="swelling-yes">Yes</label>
            </div>
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="swelling" id="swelling-no" value="no">
              <label class="form-check-label" for="swelling-no">No</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="swelling" id="swelling-slight" value="slight">
              <label class="form-check-label" for="swelling-slight">Slight</label>
            </div>
          </div>
        </div>

        <!-- Question 4: Pain or Discomfort -->
        <div class="question-group">
          <label>
            <span style="margin-right: 8px;">4Ô∏è‚É£</span> Do you experience pain, burning, or discomfort?
          </label>
          <div style="margin-left: 30px;">
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="pain" id="pain-yes" value="yes">
              <label class="form-check-label" for="pain-yes">Yes</label>
            </div>
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="pain" id="pain-no" value="no">
              <label class="form-check-label" for="pain-no">No</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="pain" id="pain-mild" value="mild">
              <label class="form-check-label" for="pain-mild">Mild</label>
            </div>
          </div>
        </div>

        <!-- Question 5: Duration -->
        <div class="question-group">
          <label>
            <span style="margin-right: 8px;">5Ô∏è‚É£</span> How long have you been experiencing these symptoms?
          </label>
          <div style="margin-left: 30px;">
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="duration" id="duration-recent" value="recent">
              <label class="form-check-label" for="duration-recent">Less than 1 week</label>
            </div>
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="duration" id="duration-weeks" value="weeks">
              <label class="form-check-label" for="duration-weeks">1-4 weeks</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="duration" id="duration-months" value="months">
              <label class="form-check-label" for="duration-months">More than 1 month</label>
            </div>
          </div>
        </div>

        <!-- Question 6: Spreading -->
        <div class="question-group">
          <label>
            <span style="margin-right: 8px;">6Ô∏è‚É£</span> Is the condition spreading or getting worse?
          </label>
          <div style="margin-left: 30px;">
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="spreading" id="spreading-yes" value="yes">
              <label class="form-check-label" for="spreading-yes">Yes, spreading</label>
            </div>
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="spreading" id="spreading-no" value="no">
              <label class="form-check-label" for="spreading-no">No change</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="spreading" id="spreading-improving" value="improving">
              <label class="form-check-label" for="spreading-improving">Improving</label>
            </div>
          </div>
        </div>

        <!-- Question 7: Discharge or Oozing -->
        <div class="question-group">
          <label>
            <span style="margin-right: 8px;">7Ô∏è‚É£</span> Is there any discharge, oozing, or crusting?
          </label>
          <div style="margin-left: 30px;">
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="discharge" id="discharge-yes" value="yes">
              <label class="form-check-label" for="discharge-yes">Yes</label>
            </div>
            <div class="form-check form-check-inline" style="margin-right: 20px;">
              <input class="form-check-input" type="radio" name="discharge" id="discharge-no" value="no">
              <label class="form-check-label" for="discharge-no">No</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="discharge" id="discharge-occasional" value="occasional">
              <label class="form-check-label" for="discharge-occasional">Occasional</label>
            </div>
          </div>
        </div>

        <!-- Submit Button -->
        <div class="text-center mt-4">
          <button type="button" id="submit-questionnaire" class="btn btn-astro" style="padding: 12px 40px; font-size: 16px; font-weight: 600;">
            üìä Submit Assessment
          </button>
        </div>

        <!-- Results Display Area -->
        <div id="questionnaire-results" style="display: none;">
          <h5>üìã Your Symptom Summary</h5>
          <div id="results-content"></div>
          <div style="margin-top: 15px; padding: 12px; background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 6px;">
            <p style="color: #92400e; margin: 0; font-size: 13px; font-weight: 600;">
              üí° <strong>Next Steps:</strong> Share this information with your dermatologist for a comprehensive evaluation.
            </p>
          </div>
        </div>
      </form>
    </div>
    {% endif %}

  </div>

  <section id="about-us" class="about-section">
    <div class="container">
      <h2 class="text-center mb-4">About DermAI</h2>
      <p class="about-text">DermAI is an AI-powered dermatology assistant designed for rapid and accurate skin disease detection. Upload an image and get professional-grade predictions with confidence scores, helping healthcare providers and patients make informed decisions.</p>
    </div>
  </section>  

  <footer class="footer-section">
    <p>‚ú® Built for Hackathon ‚Ä¢ Team GODLIKE ‚ú®</p>
  </footer>

  <!-- CHATBOT -->
  <div id="chatbot-icon-fixed" title="Open chat">üí¨</div>
  <div id="chatbot-box-fixed" class="chatbot-hidden" aria-hidden="true">
    <div class="chatbot-header-fixed">
      <div>ü§ñ Medical Assistant</div>
      <div id="chatbot-minimize-btn" style="cursor:pointer;font-size:20px;">‚Äî</div>
    </div>
    <div id="chatbot-body" class="chatbot-body-fixed" role="log" aria-live="polite"></div>
    <div class="chatbot-input-area-fixed">
      <input id="chatbot-input" type="text" placeholder="Ask about skin diseases..." autocomplete="off">
      <button id="chatbot-send">‚û§</button>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script>
(async function(){
  const icon = document.getElementById('chatbot-icon-fixed');
  const panel = document.getElementById('chatbot-box-fixed');
  const minimize = document.getElementById('chatbot-minimize-btn');
  const body = document.getElementById('chatbot-body');
  const input = document.getElementById('chatbot-input');
  const send = document.getElementById('chatbot-send');

  function addMsg(text, who){
    const d = document.createElement('div');
    d.className = 'chat-msg ' + (who === 'user' ? 'user-msg' : 'bot-msg');
    d.textContent = text;
    body.appendChild(d);
    body.scrollTop = body.scrollHeight;
  }

  async function callChatAPI(text){
    const resp = await fetch('/chat', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ query: text })
    });
    if(!resp.ok){
      throw new Error('Server error ' + resp.status);
    }
    return resp.json();
  }

  icon.addEventListener('click', () => {
    panel.classList.remove('chatbot-hidden'); icon.style.display='none';
    addMsg("Hello! I'm here to help. Ask about symptoms, remedies, or how to use the system.", 'bot');
  });
  minimize.addEventListener('click', () => { panel.classList.add('chatbot-hidden'); icon.style.display='flex'; });

  async function doSend(){
    const t = (input.value || '').trim(); if(!t) return;
    addMsg(t,'user'); input.value='';
    // typing indicator
    const typing = document.createElement('div'); typing.className='chat-msg bot-msg'; typing.id='typingId'; typing.textContent='‚Ä¶';
    body.appendChild(typing); body.scrollTop = body.scrollHeight;
    try{
      const json = await callChatAPI(t);
      document.getElementById('typingId')?.remove();
      addMsg(json.answer || "No answer.", 'bot');
      // show sources (clickable expand)
      if(json.sources && json.sources.length){
        const sdom = document.createElement('div'); sdom.style.fontSize='0.9rem'; sdom.style.marginTop='6px';
        sdom.innerHTML = "<strong>Sources:</strong><br/>";
        json.sources.forEach(src => {
          const el = document.createElement('div');
          el.style.marginTop='4px';
          el.innerHTML = `<em>${src.source_file || 'kb'}</em>: ${src.snippet.slice(0,200)}...`;
          sdom.appendChild(el);
        });
        body.appendChild(sdom);
        body.scrollTop = body.scrollHeight;
      }
    }catch(err){
      document.getElementById('typingId')?.remove();
      addMsg('Sorry ‚Äî server or network error: '+err.message, 'bot');
    }
  }

  send.addEventListener('click', doSend);
  input.addEventListener('keypress', e => { if(e.key === 'Enter'){ e.preventDefault(); doSend(); } });

})();

// Image preview functionality
(function(){
  const fileInput = document.getElementById('imageUpload');
  const previewImg = document.getElementById('previewImg');
  const fileLabel = fileInput.nextElementSibling;

  fileInput.addEventListener('change', function(e){
    const file = e.target.files[0];
    if(file){
      fileLabel.textContent = file.name;
      const reader = new FileReader();
      reader.onload = function(e){
        previewImg.src = e.target.result;
        previewImg.classList.remove('hide');
      };
      reader.readAsDataURL(file);
    } else {
      previewImg.classList.add('hide');
      fileLabel.textContent = 'Choose skin image...';
    }
  });
})();

// Symptom Questionnaire functionality
(function(){
  const submitBtn = document.getElementById('submit-questionnaire');
  const resultsDiv = document.getElementById('questionnaire-results');
  const resultsContent = document.getElementById('results-content');
  const form = document.getElementById('symptom-questionnaire');

  if(submitBtn && form){
    submitBtn.addEventListener('click', function(){
      const formData = new FormData(form);
      const answers = {};
      
      // Collect all radio button answers
      const questions = ['itching', 'redness', 'swelling', 'pain', 'duration', 'spreading', 'discharge'];
      questions.forEach(q => {
        const selected = form.querySelector(`input[name="${q}"]:checked`);
        if(selected){
          answers[q] = selected.value;
        }
      });

      // Check if at least some questions are answered
      const answeredCount = Object.keys(answers).length;
      if(answeredCount === 0){
        alert('Please answer at least one question before submitting.');
        return;
      }

      // Generate results summary
      let summary = '<div style="line-height: 2;">';
      summary += '<strong style="color: #1e40af;">Your Responses:</strong><br/><br/>';
      
      const questionLabels = {
        'itching': 'Itching',
        'redness': 'Redness/Inflammation',
        'swelling': 'Swelling',
        'pain': 'Pain/Discomfort',
        'duration': 'Duration',
        'spreading': 'Spreading/Worsening',
        'discharge': 'Discharge/Oozing'
      };

      questions.forEach(q => {
        if(answers[q]){
          const label = questionLabels[q] || q;
          const value = answers[q].charAt(0).toUpperCase() + answers[q].slice(1);
          summary += `‚Ä¢ <strong>${label}:</strong> ${value}<br/>`;
        }
      });

      summary += '</div>';

      // Add severity assessment
      let severity = 'Mild';
      let severityColor = '#2563eb';
      const yesCount = Object.values(answers).filter(v => v === 'yes' || v === 'sometimes' || v === 'mild').length;
      
      if(yesCount >= 5){
        severity = 'Moderate to Severe';
        severityColor = '#f59e0b';
      } else if(yesCount >= 3){
        severity = 'Moderate';
        severityColor = '#3b82f6';
      }

      summary += `<div style="margin-top: 15px; padding: 12px; background: #f0f9ff; border-radius: 8px; border-left: 4px solid ${severityColor};"><strong style="color: ${severityColor};">Symptom Severity Assessment:</strong> ${severity}</div>`;

      // Display results
      resultsContent.innerHTML = summary;
      resultsDiv.style.display = 'block';
      
      // Smooth scroll to results
      resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    });
  }
})();
</script>

  <script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js"></script>
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
</body>
</html>
